
<!-- saved from url=(0060)https://introcs.cs.princeton.edu/java/assignments/nbody.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>COS 126 Programming Assignment: N-Body Simulation</title>
<script type="text/javascript" src="./COS 126 Programming Assignment_ N-Body Simulation_files/swfobject.js.下载"></script>
</head>
<body bgcolor="#FFFFFF" data-new-gr-c-s-check-loaded="14.1001.0" data-gr-ext-installed="">
<table width="100%" border="0">
<tbody><tr align="LEFT" valign="BOTTOM">
<td><strong>COS 126</strong><br><br>
<strong><font size="+2">N-Body Simulation</font></strong></td>
<td align="RIGHT" valign="BOTTOM">
<strong>Programming Assignment</strong><br><br>
</td></tr></tbody></table>
<hr>
<p>
In 1687 Sir Isaac Newton formulated the principles governing the
the motion of two particles under the influence of their
mutual gravitational attraction in his famous <em>Principia</em>.
However, Newton was unable to solve the problem for three particles.
Indeed, in general,
systems of three or more particles can only be solved numerically.
Your challenge is to write a program to simulate the motion of
<em>N</em> particles in the plane,
mutually affected by gravitational forces, and animate the results.
Such methods are widely used in cosmology, 
semiconductors, and fluid dynamics to study complex physical
systems. Scientists also apply the same techniques to other pairwise
interactions including Coulombic, Biot-Savart, and van der Waals.

</p><p>
<font _mstmutation="1"><b _mstmutation="1">The physics.</b>
We review the equations governing the motion of the particles, according
to Newton's laws of motion and gravitation.
Don't worry if your physics is a bit rusty; all of the necessary formulas
are included below.
We'll assume for now that the position (<em _mstmutation="1">r<sub>x</sub>, r<sub>y</sub></em>) and
velocity (<em _mstmutation="1">v<sub>x</sub>, v<sub>y</sub></em>) of each particle is known.
In order to model the dynamics of the system, we must know the net
force exerted on each particle.

</font></p><p>

</p><ul>

<p></p><li>
<font _mstmutation="1"><b _mstmutation="1">Pairwise force.</b>
<em _mstmutation="1">Newton's law of universal gravitation</em> asserts that
the strength of the gravitational force between two particles is given by
the product of their masses divided by the square of the distance
between them, scaled by the gravitational constant <em _mstmutation="1">G</em>
(6.67 × 10<sup _mstmutation="1">-11</sup> N m<sup _mstmutation="1">2</sup> / kg<sup _mstmutation="1">2</sup>).
The pull of one particle towards another acts on the line between them.
Since we are using Cartesian coordinates to represent the position of
a particle, it
is convenient to break up the force into its <em _mstmutation="1">x</em>- and <em _mstmutation="1">y</em>-components
(<em _mstmutation="1">F<sub>x</sub>, F<sub>y</sub></em>) as illustrated below.

</font><p>
</p><center>
<img src="./COS 126 Programming Assignment_ N-Body Simulation_files/nbody.png" alt="force diagram">
</center>

</li><li>
<font _mstmutation="1"><b _mstmutation="1">Net force.</b>
The <em _mstmutation="1">principle of superposition</em> says that
the net force acting on a particle in the <em _mstmutation="1">x</em>-  or <em _mstmutation="1">y</em>-direction is the sum
of the pairwise forces acting on the particle in that direction.


</font><p></p></li><li>
<font _mstmutation="1"><b _mstmutation="1">Acceleration.</b>
<em _mstmutation="1">Newton's second law of motion</em> postulates that
the accelerations in the <em _mstmutation="1">x</em>- and <em _mstmutation="1">y</em>-directions are given by:
<em _mstmutation="1">a<sub>x</sub> = F<sub>x</sub> / m,  a<sub>y</sub> = F<sub>y</sub> / m</em>.

</font></li></ul>


<p>
<font _mstmutation="1"><b _mstmutation="1">The numerics.</b>&nbsp;
We use the <em _mstmutation="1">leapfrog finite difference approximation scheme</em>
to numerically integrate the above equations: this is the
basis for most astrophysical simulations of gravitational systems.
In the leapfrog scheme, we discretize time, and update the time
variable <em _mstmutation="1">t</em> in increments of the <em _mstmutation="1">time quantum</em> Δ<em _mstmutation="1">t</em>
(measured in seconds).
We maintain the position
(<em _mstmutation="1">r<sub>x</sub></em>, <em _mstmutation="1">r<sub>y</sub></em>)
and velocity
(<em _mstmutation="1">v<sub>x</sub></em>, <em _mstmutation="1">v<sub>y</sub></em>)
 of each particle at each time step.
The steps below illustrate
how to evolve the positions and velocities of the particles.

</font></p><ol>

<p></p><li><font _mstmutation="1">
For each particle: Calculate the net force 
(<em _mstmutation="1">F<sub>x</sub>, F<sub>y</sub></em>)
at the current time <em _mstmutation="1">t</em>
acting on that particle using Newton's
law of gravitation and the principle of superposition. 
Note that force is a vector (i.e., it has direction).  
In particular, be aware that Δ<em _mstmutation="1">x</em> and Δ<em _mstmutation="1">y</em>
are signed (positive or negative).  
In the diagram above, when you compute the force the sun exerts on the earth,
the sun is pulling the earth up (Δ<em _mstmutation="1">y</em> positive) and to the 
right (Δ<em _mstmutation="1">x</em> positive).

</font><p></p></li><li><font _mstmutation="1">
For each particle:

</font><ol type="a">
<p></p><li><font _mstmutation="1">
Calculate its acceleration (<em _mstmutation="1">a<sub>x</sub>, a<sub>y</sub></em>) at
time <em _mstmutation="1">t</em>
using the net force computed in Step 1 and Newton's second law of motion:
<em _mstmutation="1">a<sub>x</sub> = F<sub>x</sub> / m,  a<sub>y</sub> = F<sub>y</sub> / m</em>.

</font><p></p></li><li><font _mstmutation="1">
Calculate its new velocity (<em _mstmutation="1">v<sub>x</sub>, v<sub>y</sub></em>) at the next time
step by using the acceleration computed in Step 2a
and the velocity from the old time step:
Assuming the acceleration remains constant in this interval, the new 
velocity is 
(<em _mstmutation="1">v<sub>x</sub></em> + Δ<em _mstmutation="1">t</em> <em _mstmutation="1">a<sub>x</sub></em>,
 <em _mstmutation="1">v<sub>y</sub></em> + Δ<em _mstmutation="1">t</em> <em _mstmutation="1">a<sub>y</sub></em>).

</font><p></p></li><li>
Calculate its new position (<em>r<sub>x</sub>, r<sub>y</sub></em>) at time
<em>t</em> + Δ<em>t</em> by using the velocity computed in Step 2b
and its old position at time <em>t</em>:
Assuming the velocity remains constant in this interval,
the new position is 
(<em>r<sub>x</sub></em> + Δ<em>t</em> <em>v<sub>x</sub></em>,
 <em>r<sub>y</sub></em> + Δ<em>t</em> <em>v<sub>y</sub></em>).
</li></ol>

<p></p></li><li> For each particle: Draw it using the position computed in Step 2.
</li></ol><font _mstmutation="1">

The simulation is more accurate when Δ<em _mstmutation="1">t</em> is
very small, but this comes at the price of more computation.


</font><p><b>Creating an animation.</b>
Draw each particle at its current position using standard drawing,
and repeat this process at each time step until a designated stopping time.
By displaying this sequence of snapshots (or frames) in rapid succession,
you will create the illusion of movement.
After each time step (i) draw the background image <tt>starfield.jpg</tt>,
(ii) redraw all the bodies in their new positions,
and
(iii)  control the animation speed using <tt>StdDraw.show()</tt>.


</p><p><b>Input format.</b>
The input format is a text file that contains the information for a particular universe.
The first value is an integer <em>N</em> which represents the number of particles.
The second value is a real number <em>R</em> which represents the
<em>radius</em> of the universe:
assume all particles will have 
<em>x</em>- and <em>y</em>-coordinates that remain between -<em>R</em> and <em>R</em>.
Finally, there are <em>N</em> rows, and each row contains 6 values.
The first two values are the <em>x</em>- and <em>y</em>-coordinates of
the initial position;
the second two values
are the <em>x</em>- and <em>y</em>-components of the initial velocity;
the third value is the mass; the last value is a <tt>String</tt> that is
the name of an image file used to display the particle.
As an example,
<a href="ftp://ftp.cs.princeton.edu/pub/cs126/nbody/planets.txt">planets.txt</a>
contains data for our solar system (in SI units).


</p><p>


</p><blockquote><pre>% <b>more planets.txt</b>
5
2.50e+11
 1.4960e+11  0.0000e+00  0.0000e+00  2.9800e+04  5.9740e+24    earth.gif
 2.2790e+11  0.0000e+00  0.0000e+00  2.4100e+04  6.4190e+23     mars.gif
 5.7900e+10  0.0000e+00  0.0000e+00  4.7900e+04  3.3020e+23  mercury.gif
 0.0000e+00  0.0000e+00  0.0000e+00  0.0000e+00  1.9890e+30      sun.gif
 1.0820e+11  0.0000e+00  0.0000e+00  3.5000e+04  4.8690e+24    venus.gif</pre></blockquote>

<p>
<font _mstmutation="1"><b _mstmutation="1">Your program.</b> &nbsp;
Write a program <tt _mstmutation="1">NBody.java</tt> that:
</font></p><ul>
<p></p><li><font _mstmutation="1">Reads two <tt _mstmutation="1">double</tt> <em _mstmutation="1">command-line arguments</em>
<em _mstmutation="1">T</em> and  Δ<em _mstmutation="1">t</em>.
</font><p></p></li><li><font _mstmutation="1">Reads in the universe from <em _mstmutation="1">standard input</em> using <tt _mstmutation="1">StdIn</tt>.
</font><p></p></li><li><font _mstmutation="1"> Simulates the universe, starting at time <em _mstmutation="1">t</em> = 0.0,
and continuing as long as <em _mstmutation="1">t</em> &lt; <em _mstmutation="1">T</em>,
using the leapfrog scheme described above.
</font><p></p></li><li><font _mstmutation="1"> Animates the results to <em _mstmutation="1">standard drawing</em> using <tt _mstmutation="1">StdDraw</tt>.
</font><p></p></li><li> Prints the state of the universe at the end of the simulation
(in the same format as the input file) to <em>standard output</em> 
using <tt>StdOut</tt>.
</li></ul><font _mstmutation="1">
Maintain several parallel arrays to store the data.
To make the computer simulation, write a loop that 
repeatedly updates the position and velocity of the particles.
Before plotting, use
<tt _mstmutation="1">StdDraw.setXscale(-R, +R)</tt> and 
<tt _mstmutation="1">StdDraw.setYscale(-R, +R)</tt> to scale the physics
coordinates to the screen coordinates.

</font><p>

</p><p><b>Optional finishing touch.</b>
For a finishing touch, play the theme to
<em>2001: A Space Odyssey</em> using 
<tt>StdAudio</tt> and the file 
<tt>2001.mid</tt>. It's a one-liner using the method <tt>StdAudio.play()</tt>.
If you have trouble doing this, make sure you note it in your <tt>readme.txt</tt>.

</p><p><b>Compiling and executing your program.</b>
Follow these instructions 
[
<a href="http://introcs.cs.princeton.edu/15inout/windows-cmd.html">Windows</a> ·
<a href="http://introcs.cs.princeton.edu/15inout/mac-cmd.html">Mac</a> ·
<a href="http://introcs.cs.princeton.edu/15inout/linux-cmd.html">Linux</a>
]
to configure the command line on your system.
To compile your program <em>from the command line</em>, type:

</p><blockquote><pre>% <b>javac NBody.java</b></pre></blockquote>

<p>
in your terminal application.
To execute your program <em>from the command line</em>,
redirecting from the file <tt>planets.txt</tt> to standard input,
type:
</p><p>

</p><blockquote><pre>% <b>java NBody 157788000.0 25000.0 &lt; planets.txt</b></pre></blockquote>


<blockquote><pre>5
2.50e11
 1.4925e+11 -1.0467e+10  2.0872e+03  2.9723e+04  5.9740e+24    earth.gif
-1.1055e+11 -1.9868e+11  2.1060e+04 -1.1827e+04  6.4190e+23     mars.gif
-1.1708e+10 -5.7384e+10  4.6276e+04 -9.9541e+03  3.3020e+23  mercury.gif
 2.1709e+05  3.0029e+07  4.5087e-02  5.1823e-02  1.9890e+30      sun.gif
 6.9283e+10  8.2658e+10 -2.6894e+04  2.2585e+04  4.8690e+24    venus.gif
</pre></blockquote>


<!--
<p>
<blockquote>
<a href = "nbody-planets.jpg">
<IMG SRC="nbody-planets.jpg" width=256 height=256 alt = "N-body simulation of planets.txt">
</a>
</blockquote>

<p>
It produces <a href = "nbody-planets.mov">this animation</a>.
-->

<p>
</p><blockquote>
<p id="preview"><b>Your browser can not display this movie.<br>
Be sure that Javascript is enabled and
that you have <a href="http://get.adobe.com/flashplayer">Flash 9.0.124</a> or better.</b> </p>
<script type="text/javascript">
var s1 = new SWFObject('player.swf','player','500','520','9.0.124');
s1.addParam('allowfullscreen','true');
s1.addParam('allowscriptaccess','always');
s1.addParam('flashvars','file=NbodyPlanetsSound.mov&image=NbodyPlanetsSound.jpg&screencolor=ffffff&stretching=none');
s1.write('preview');
</script>
</blockquote>


<p><br>
<font _mstmutation="1"><b _mstmutation="1">Getting started.</b>
To get started, download the <tt _mstmutation="1">nbody</tt> subdirectory 
from the 
<a href="ftp://ftp.cs.princeton.edu/pub/cs126/" _mstmutation="1">COS 126 ftp site</a>.
It contains our standard libraries that you will need for input and output
(<tt _mstmutation="1">StdIn.java</tt>, <tt _mstmutation="1">StdOut.java</tt>, <tt _mstmutation="1">StdDraw.java</tt>,
and <tt _mstmutation="1">StdAudio.java</tt>).
It also includes many sample universes (such as <tt _mstmutation="1">planets.txt</tt>)
that you can use to test your program, along with image files
of the planets.
Finally, it includes the <tt _mstmutation="1">readme.txt</tt> template.

</font></p><p>
<font _mstmutation="1"><b _mstmutation="1">Submission.</b>
Submit <tt _mstmutation="1">NBody.java</tt>. Also submit a
<a href="ftp://ftp.cs.princeton.edu/pub/cs126/nbody/readme.txt" _mstmutation="1">readme.txt</a>
file and answer the questions.


</font></p><p><b>Extra credit.</b>
Submit an alternate universe (in our input format) along with the necessary image files.
If its behavior is sufficiently interesting, we'll award extra credit.

</p><p>
<font _mstmutation="1"><b _mstmutation="1">Challenge for the bored.</b>
There are limitless opportunities for additional excitement and discovery here.
Try adding other features, such as supporting elastic or inelastic collisions.
Or, make the simulation three-dimensional by doing calculations for <em _mstmutation="1">x</em>-,
<em _mstmutation="1">y</em>-, and <em _mstmutation="1">z</em>-coordinates, then using the <em _mstmutation="1">z</em>-coordinate
to vary the sizes of the planets.
Add a rocket ship that launches from one planet and has to land on another.
Allow the rocket ship to exert force with the consumption of fuel.
</font><br><br>

</p><address><small>Copyright © 1999–2010, <a href="https://introcs.cs.princeton.edu/~rs/">Robert Sedgewick</a> and
<a href="https://introcs.cs.princeton.edu/~wayne">Kevin Wayne</a>.

</small>
</address>

</body><grammarly-desktop-integration data-grammarly-shadow-root="true"></grammarly-desktop-integration></html>